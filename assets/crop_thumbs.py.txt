import os
from PIL import Image

# 原图文件夹
src_folder = "gallery_src"
# 输出文件夹
dst_folder = "gallery_thumbs"
# 缩略图大小
size = (150, 150)

os.makedirs(dst_folder, exist_ok=True)

print("📸 开始裁剪缩略图...\n")

for filename in os.listdir(src_folder):
    if filename.lower().endswith((".png", ".jpg", ".jpeg", ".gif")):
        src_path = os.path.join(src_folder, filename)
        dst_path = os.path.join(dst_folder, filename)

        try:
            img = Image.open(src_path)
            # 居中裁剪为正方形
            w, h = img.size
            min_side = min(w, h)
            left = (w - min_side) / 2
            top = (h - min_side) / 2
            right = (w + min_side) / 2
            bottom = (h + min_side) / 2
            img = img.crop((left, top, right, bottom))

            # 调整大小
            img = img.resize(size, Image.LANCZOS)
            img.save(dst_path)

            print(f"✅ 已处理: {filename}")
        except Exception as e:
            print(f"❌ 出错 {filename}: {e}")

print("\n🎉 全部完成！结果在 →", dst_folder)
